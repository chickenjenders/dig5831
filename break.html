<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Break Time — Hell OS</title>
  <style>
    :root {
      --paper: #f6f1e7;
      --paper-dk: #efe6d8;
      --ink: #2a2a2a;
      --quiet: #6c6257;
      --line: #c9bba6;
      --accent: #b22323;
      --accent-dk: #8f1b1b;
      --workspace: #e9e2d0;
    }

    body {
      font-family: "Helvetica Neue", Arial, sans-serif;
      margin: 0;
      background: var(--workspace);
      color: var(--ink);
      overflow: hidden;
    }

    /* Toolbar */
    #toolbar {
      background: var(--accent);
      color: #fff;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 18px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, .3);
    }

    /* Frame */
    #workspace {
      display: flex;
      justify-content: center;
      padding: 28px;
      height: calc(100vh - 60px);
      box-sizing: border-box;
    }

    #frame {
      width: 960px;
      height: 100%;
      background: var(--paper);
      border: 1px solid var(--line);
      border-radius: 4px;
      box-shadow: 0 0 24px rgba(0, 0, 0, .35);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    #frameHeader {
      background: var(--paper-dk);
      border-bottom: 1px solid var(--line);
      padding: 10px 18px;
      display: flex;
      justify-content: space-between;
      color: var(--quiet);
      font-size: 14px;
    }

    /* Break scene */
    #scene {
      position: relative;
      flex: 1;
      overflow: hidden;
      background: #ddd;
    }

    #bg {
      position: absolute;
      inset: 0;
      object-fit: cover;
      width: 100%;
      height: 100%;
      filter: saturate(.95) contrast(1.02);
    }

    /* Timer (top-right) */
    #timerWrap {
      position: absolute;
      top: 14px;
      right: 14px;
      width: 240px;
      background: rgba(0, 0, 0, .35);
      color: #fff;
      border-radius: 8px;
      padding: 8px 10px;
      font-size: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, .25);
      backdrop-filter: blur(2px);
    }

    #timerLabel {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
      opacity: .9;
    }

    #timeText {
      font-family: monospace;
    }

    #timerBar {
      width: 100%;
      height: 10px;
      background: #2c2c2c;
      border-radius: 6px;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, .2);
    }

    #timerFill {
      height: 100%;
      width: 100%;
      background: var(--accent);
      transition: width .5s linear;
    }

    /* Invisible hotspots */
    .hotspot {
      position: absolute;
      cursor: pointer;
      background: transparent;
    }

    .hotspot.francine {
      left: 5%;
      bottom: 15%;
      width: 15%;
      height: 30%;
    }

    .hotspot.cecil {
      left: 5%;
      top: 15%;
      width: 20%;
      height: 25%;
    }

    .hotspot.raquel {
      right: 5%;
      bottom: 15%;
      width: 15%;
      height: 30%;
    }

    .hotspot.jeffrey {
      right: 5%;
      top: 15%;
      width: 20%;
      height: 25%;
    }

    /* Dialogue UI */
    #dim {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, .35);
      display: none;
      /* sit above the scene but below character portraits */
      z-index: 20;
    }

    #dialogue {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(246, 241, 231, .96);
      border-top: 2px solid var(--line);
      box-shadow: 0 -10px 24px rgba(0, 0, 0, .25);
      padding: 14px 16px 12px;
      display: none;
      /* place dialogue above the dim and characters */
      z-index: 40;
    }

    #name {
      font-weight: 700;
      color: var(--accent-dk);
      margin: 0 0 6px 0;
    }

    #text {
      min-height: 64px;
      line-height: 1.5;
    }

    #choices {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .choice {
      background: #fff;
      border: 1px solid var(--line);
      border-radius: 6px;
      padding: 8px 12px;
      cursor: pointer;
      font-size: 14px;
    }

    .choice:hover {
      border-color: var(--accent);
    }

    /* Character portraits with slide animation */
    #charArea {
      position: absolute;
      bottom: 160px;
      /* closer to dialogue box */
      width: 260px;
      height: auto;
      display: none;
      pointer-events: none;
      background: transparent;
      transition: all 0.3s ease;
      /* ensure portraits are visible above the dim overlay */
      z-index: 30;
    }

    #charArea img {
      width: auto;
      height: 300px;
      object-fit: contain;
      background: transparent;
      transform: translateX(0);
      opacity: 1;
      filter: brightness(1.05) contrast(1.05) drop-shadow(0 6px 12px rgba(0, 0, 0, 0.4));
      transition: all 0.6s ease-out;
    }

    #charArea.left img {
      transform: translateX(-60px);
    }

    #charArea.right img {
      transform: translateX(60px);
    }

    #charArea.show img {
      transform: translateX(0);
      opacity: 1;
      filter: brightness(1.1) contrast(1.1) drop-shadow(0 6px 12px rgba(0, 0, 0, 0.4));
    }

    #charArea.left {
      left: 60px;
    }

    #charArea.right {
      right: 60px;
    }

    /* Break over popup */
    #overlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, .5);
      display: none;
      z-index: 50;
    }

    #popup {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 420px;
      max-width: calc(100% - 40px);
      background: #fdf9f2;
      border: 2px solid var(--accent);
      border-radius: 10px;
      box-shadow: 0 12px 28px rgba(0, 0, 0, .45);
      display: none;
      z-index: 51;
    }

    #popupHeader {
      background: var(--accent);
      color: #fff;
      padding: 8px 12px;
      border-top-left-radius: 8px;
      border-top-right-radius: 8px;
      font-weight: 700;
    }

    #popupBody {
      padding: 16px 16px 10px;
    }

    #popupActions {
      padding: 0 16px 16px;
      text-align: right;
    }

    .btn {
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      padding: 10px 16px;
      font-size: 15px;
    }

    .btn:hover {
      background: var(--accent-dk);
    }
  </style>
</head>

<body>

  <div id="toolbar">
    <div>Internal Document — H.Inc</div>
    <div>Break Time</div>
  </div>

  <div id="workspace">
    <div id="frame">
      <div id="frameHeader">
        <div>Employee: #000665</div>
        <div>Department: Soul Logistics</div>
      </div>
      <div id="scene">
        <img id="bg" src="office_bg.png" alt="Office">
        <div id="timerWrap">
          <div id="timerLabel">
            <span>Break Time Remaining</span>
            <span id="timeText">03:00</span>
          </div>
          <div id="timerBar">
            <div id="timerFill"></div>
          </div>
        </div>

        <div class="hotspot francine" data-name="Francine" data-side="left"></div>
        <div class="hotspot cecil" data-name="Cecil" data-side="left"></div>
        <div class="hotspot raquel" data-name="Raquel" data-side="right"></div>
        <div class="hotspot jeffrey" data-name="Jeffrey" data-side="right"></div>

        <div id="charArea"><img src="" alt=""></div>

        <div id="dim"></div>
        <div id="dialogue">
          <p id="name"></p>
          <div id="text"></div>
          <div id="choices"></div>
        </div>

        <div id="overlay"></div>
        <div id="popup">
          <div id="popupHeader">Break Over</div>
          <div id="popupBody">Your four-minute sustenance interval has expired. Return to work immediately.</div>
          <div id="popupActions"><button class="btn" onclick="window.location.href='work.html'">Get Back to
              Work</button></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const coworkers = {
      Francine: {
        img: 'francine.png',
        dialogue: [
          { text: 'Survival is a slow form of surrender. I recommend speed.', choices: ['What do you suggest?', 'I like surrendering…', 'Leave Conversation'] },
          { text: 'Promotion isn’t about success. It’s about visibility.', choices: ['Visibility?', 'Sounds exhausting', 'Leave Conversation'] }
        ]
      },
      Cecil: {
        img: 'cecil.png',
        dialogue: [
          { text: 'Keep your head down. Floor 404 is always watching.', choices: ['Who’s on 404?', 'You’re paranoid', 'Leave Conversation'] },
          { text: 'I used to ask questions too. Now I just sign forms.', choices: ['That’s bleak', 'Good advice', 'Leave Conversation'] }
        ]
      },
      Raquel: {
        img: 'raquel.png',
        dialogue: [
          { text: 'I heard The Cleanse is coming. Only the most loyal survive.', choices: ['The Cleanse?', 'I’ll pass', 'Leave Conversation'] },
          { text: 'I’m close to promotion. Just need to sacrifice sleep forever.', choices: ['Maybe nap anyway', 'Ambition is eternal', 'Leave Conversation'] }
        ]
      },
      Jeffrey: {
        img: 'jeffrey.png',
        dialogue: [
          { text: 'I stopped caring about strikes. They can’t erase me.', choices: ['That’s bold', 'You’re insane', 'Leave Conversation'] },
          { text: 'Wanna take some of my quota? I’ll owe you.', choices: ['Deal', 'No thanks', 'Leave Conversation'] }
        ]
      }
    };

    let timer = 180;
    const timeText = document.getElementById('timeText');
    const fill = document.getElementById('timerFill');
    const overlay = document.getElementById('overlay');
    const popup = document.getElementById('popup');
    const charArea = document.getElementById('charArea');
    const dialogue = document.getElementById('dialogue');
    const nameEl = document.getElementById('name');
    const textEl = document.getElementById('text');
    const choicesEl = document.getElementById('choices');
    const dim = document.getElementById('dim');

    setInterval(() => {
      timer--;
      if (timer <= 0) { endBreak(); }
      const min = Math.floor(timer / 60).toString().padStart(2, '0');
      const sec = (timer % 60).toString().padStart(2, '0');
      timeText.textContent = `${min}:${sec}`;
      fill.style.width = `${(timer / 180) * 100}%`;
    }, 1000);

    function endBreak() {
      overlay.style.display = 'block';
      popup.style.display = 'block';
    }

    document.querySelectorAll('.hotspot').forEach(h => {
      h.addEventListener('click', () => {
        startDialogue(h.dataset.name, h.dataset.side);
      });
    });

    function startDialogue(name, side) {
      const coworker = coworkers[name];
      if (!coworker) return;
      charArea.classList.remove('left', 'right', 'show');
      charArea.style.display = 'block';
      charArea.querySelector('img').src = coworker.img;
      charArea.classList.add(side);
      setTimeout(() => charArea.classList.add('show'), 50);

      dialogue.style.display = 'block';
      dim.style.display = 'block';
      let idx = 0;
      nextLine();

      function nextLine() {
        const line = coworker.dialogue[idx];
        if (!line) { endConversation(); return; }
        nameEl.textContent = name;
        typeText(line.text, () => renderChoices(line.choices));
      }

      function renderChoices(arr) {
        choicesEl.innerHTML = '';
        arr.forEach(c => {
          const btn = document.createElement('div');
          btn.className = 'choice';
          btn.textContent = c;
          btn.onclick = () => {
            if (c.includes('Leave')) endConversation();
            else { idx++; nextLine(); }
          };
          choicesEl.appendChild(btn);
        });
      }
    }

    function typeText(str, done) {
      textEl.textContent = '';
      let i = 0;
      const interval = setInterval(() => {
        textEl.textContent = str.slice(0, i++);
        if (i > str.length) { clearInterval(interval); done && done(); }
      }, 25);
    }

    function endConversation() {
      dialogue.style.display = 'none';
      dim.style.display = 'none';
      // Slide out
      charArea.classList.remove('show');
      setTimeout(() => { charArea.style.display = 'none'; }, 500);
    }
  </script>

</body>

</html>